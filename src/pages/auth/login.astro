---
import { Button } from "@/components/ui/react/button";
import { Input } from "@/components/ui/react/input";
import AuthLayout from "@/layouts/AuthLayout.astro";
import Text from "@/components/Text.astro";
import GoogleAuth from "@/components/ui/react/google-auth";

import { isLoggedIn } from "@/utilities/helpers/verifyUser";

const cookie = Astro.cookies.get(import.meta.env.COOKIE_NAME)?.value;
const loggedIn = isLoggedIn(cookie);

if (loggedIn) {
  return Astro.redirect("/dashboard");
}
---

<AuthLayout title="Login | Pillar Bids">
  <div class="flex justify-end flex-end" slot="auth-slot">
    <a href="/">
      <p>Sign up</p>
    </a>
  </div>

  <div
    class="flex flex-col h-full justify-center self-center items-center align-middle"
    slot="auth-slot"
  >
    <form
      action="/api/auth/login"
      method="post"
      class="flex flex-col w-full justify-center self-center items-center align-middle"
    >
      <Text type="h4" content="Login your account" />
      <Text
        type="p"
        content="Login with your email and account password"
        className="muted text-[14px]"
      />
      <Input
        type="email"
        placeholder="Email"
        name="email"
        className="flex h-9 rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 w-2/3 my-4"
      />
      <Input
        type="password"
        name="password"
        placeholder="Password"
        className="flex h-9 rounded-md border border-input bg-transparent px-3 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 w-2/3 mb-4"
      />
      <Button className="w-2/3 bg-primary">Login</Button>
    </form>

    <div class="relative my-4">
      <div class="flex items-center mt-4"><span class="w-full"></span></div><div
        class="relative flex justify-center text-xs uppercase"
      >
        <span class="px-2 text-muted-foreground">Or continue with</span>
      </div>
    </div>

    <form
      action="/api/auth/google/google-auth"
      class="flex justify-center w-full"
    >
      <GoogleAuth client:load />
    </form>
  </div>
</AuthLayout>
